// c592c52381d43a6604b3fc657c5dc6bee61aa288bfa37e8fc54140841267338d
// 1fd15c358e2df47f5dde9ca2102c30d5e26d202642169d3b2491b89c9acc0788
// Execute with regsvr32 /s /i
// .CR1 - extension
// D3F3CEBB972965 - xorkey
// 04780006780E6407 - mutex
// dbg.txt - log
// YOUR_FILES.txt - note
// cr1-silvergold1@protonmail.com - ransom
// https://exchange.xforce.ibmcloud.com/collection/99c7156cff70e1d8e1687ab7dadc8c0e
// https://www.intezer.com/blog-purelocker-ransomware-being-used-in-targeted-attacks-against-servers/

rule purelocker_vsigs
{
		condition:
			new_file
				and
				(
			(signatures matches /.*PureLocker.*/)
				or
			(signatures matches /.*PURELOCKER.*/)
				)
}

rule purelocker_imphash
{
		condition:
    	new_file
      	and
      	(
			(imphash contains "cc2d1da2e5791504e1bf336fd23d0a28")
				or
			(imphash contains "59e0431c441419a7ff332859b546442e")
      	)
}

rule purelocker_vtname
{
		condition:
			new_file
				and
      filesize < 200KB
      	and
      	(
			(file_name contains "cryptopp")
      	or
			(file_name contains "cryptopp.dll")
      	or
			(file_name contains "cryptopp_w2.dll")
      	)
}

import pe
rule purelocker_exports
{
		condition:
			new_file
				and
			pe.exports("DeleteMusic")
				and
			pe.exports("FindMusic")
				and
			pe.exports("MoveMusic")
				and
			pe.exports("SeekMusic")
				and
			pe.exports("UploadMusic")
				and
			pe.exports("DllRegisterServer")
}

rule purelocker_pe
{
		strings:
			$file = "cryptopp.dll"
			$import0 = "DeleteMusic"
			$import1 = "FindMusic"
			$import2 = "MoveMusic"
			$import3 = "SeekMusic"
			$import4 = "UploadMusic"
      $import5 = "DllRegisterServer"

		condition:
			uint16(0) == 0x5a4d and filesize < 200KB and all of them
}

rule purelocker_inmemory_note
{
		strings:
    	$note0 = "To decrypt your files contact us at: cr1-silvergold1@protonmail.com" wide
			$note1 = "Shadows copies were removed, original files were overwritten, renamed and deleted using safe methods." wide
			$note2 = ", after that the recovery of your files will not be possible." wide
			$note3 = "Your private key will be deleted after 7 days starting from: " wide
			$note4 = "All your files have been encrypted using: AES-256-CBC + RSA-4096." wide
			$note5 = "Recovery is not possible without own RSA-4096 private key." wide
			$note6 = "Only we can decrypt your files!" wide

		condition:
    	all of them
}
