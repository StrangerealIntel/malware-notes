# Snatch ransomware

## SHA256 hashes
0ce4c4af321ff02928aacf105f03dead87e85003080586615755f278770f5adb  
28125dae3ab7b11bd6b0cbf318fd85ec51e75bca5be7efb997d5b950094cd184  
36a4311ef332b0b5db62f8fcabf004fdcfbbde62f791839a8be0314604d814c4  
d0ddc221b958d9b4c7d9612dd2577bec35d157b41aa50210c2ae5052d054ff33  
e8931967ed5a4d4e0d7787054cddee8911a7740b80373840b276f14e36bda57d  
78816ea825209162f0e8a1aae007691f9ce39f1f2c37d930afaf5ac3af78e852  
fe8ba1eaf69b1eba578784d5ab77e54caae9d90c2fb95ad2baaaef6b69a2d6cb  

## References
https://twitter.com/VK_Intel/status/1191414501297528832/  

## Notes
- Ransom note `Readme_Restore_Files.txt` in the early version of the ransomware
- Later format was changed to include a random string: `RESTORE_DGLNL_FILES.txt`
- Ransomed files with `.snatch` extension
- Later the encrypted extension was changed to include the same random string: `.dglnl`
- Ransom e-mail: `imBoristheBlade@protonmail.com`, later versions of snatch use different addresses
- Other ransom e-mails: `doctor666@mail.fr` or `doctor666@cock.li`
- Go Build ID: `9sbGxHyc5vSAXzwvg6iZ/c_gG_xy9d6xmNt9nMlii/HdKHUjGFLxliYJycPc5E/yTT_FNpw78SfII62lGUn`
- Go build ID: `2KZVw_piBNB6c74hlRt4/ueMyrcUcK4ismcjykWop/ZQYGFEYcaBSofxZbcs4g/GK-7e3PY8vHyy_lSkbVi`
- Go build ID: `jPF3Jrx2uZ7VjN0GyDBL/x3B31XZylJgOhAVFZiym/o_aCHMB9kgaxIibXVOox/VQQhgCuLOuABGRrXzFdl`
- Creates service: `net stop SuperBackupMan`
- Creates registry entry: `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\SuperBackupMan`
- Observed command execution:
- `vssadmin delete shadows /all /quiet`
- `bcdedit.exe /set {current} safeboot minimal`
- `shutdown.exe /r /f /t 00`

## Yara rules
```yara
rule snatch_caro
{
  condition:
    new_file and ((signatures matches /.*Snatch.*/) or (signatures matches /.*Ransom.*Gocoder.*/))
}

import "cuckoo"
rule snatch_service
{
	condition:
		cuckoo.registry.key_access(/<HKLM>\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Minimal\\SuperBackupMan/)
			or
		cuckoo.registry.key_access(/HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Minimal\\SuperBackupMan/)
			or
		cuckoo.registry.key_access(/HKLM\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Minimal\\SuperBackupMan/)
}
```
