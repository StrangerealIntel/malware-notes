# Snatch ransomware

## SHA256 hashes
eebc57e9e683a3c5391692c1c3afb37f3cb539647f02ddd09720979426790f56  
78816ea825209162f0e8a1aae007691f9ce39f1f2c37d930afaf5ac3af78e852  
80cc8e51b3b357cfc7115e114cecabc5442c12c143a7a18ab464814de7a66ab4  
ebcded04429c4178d450a28e5e190d6d5e1035abcd0b2305eab9d29ba9c0915a  
fe8ba1eaf69b1eba578784d5ab77e54caae9d90c2fb95ad2baaaef6b69a2d6cb  
28125dae3ab7b11bd6b0cbf318fd85ec51e75bca5be7efb997d5b950094cd184  
0ce4c4af321ff02928aacf105f03dead87e85003080586615755f278770f5adb  
36a4311ef332b0b5db62f8fcabf004fdcfbbde62f791839a8be0314604d814c4  
d0ddc221b958d9b4c7d9612dd2577bec35d157b41aa50210c2ae5052d054ff33  
e8931967ed5a4d4e0d7787054cddee8911a7740b80373840b276f14e36bda57d  
ae9cdbb717625506ed0df7af153dc2741395655aeb1da2f91079e3ea616af6a1  
5f24536e48f406177a9a630b0140baadff1e29f36b02095b25e7e21c146098bb  
c0f506e98f416412b3a9dcd018341afab15e36b15bac89d3b02ff773b6cc85a6  
36a4311ef332b0b5db62f8fcabf004fdcfbbde62f791839a8be0314604d814c4  
8c9fab558b3e9e21936a91422d9e2666f210c5fd7d9b0fd08d2353adb64a4c00  

## Notes
- Ransom note `Readme_Restore_Files.txt` in the early version of the ransomware
- Later format was changed to include a random string: `RESTORE_DGLNL_FILES.txt`
- Ransomed files with `.snatch` extension
- Later the encrypted extension was changed to include the same random string: `.dglnl`
- Other extensions: `.wvtr0`
- Ransom e-mail: `imBoristheBlade@protonmail.com`, later versions of snatch use different addresses
- Other ransom e-mails: `doctor666@mail.fr` or `doctor666@cock.li`
- Other ransom e-mails: `newrecoveryrobot@pm.me`
- Go Build ID: `9sbGxHyc5vSAXzwvg6iZ/c_gG_xy9d6xmNt9nMlii/HdKHUjGFLxliYJycPc5E/yTT_FNpw78SfII62lGUn`
- Go build ID: `2KZVw_piBNB6c74hlRt4/ueMyrcUcK4ismcjykWop/ZQYGFEYcaBSofxZbcs4g/GK-7e3PY8vHyy_lSkbVi`
- Go build ID: `jPF3Jrx2uZ7VjN0GyDBL/x3B31XZylJgOhAVFZiym/o_aCHMB9kgaxIibXVOox/VQQhgCuLOuABGRrXzFdl`
- Go build ID: `ULgusZVAlPcWOJcj9LKW/fOp_xyXqQQO5nzk3CZIW/LV-l8Ye8SLuN39dCmiDH/_34hEcu3a_yVC0sdeBdP`
- Creates service: `net stop SuperBackupMan`
- Creates registry entry: `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SafeBoot\Minimal\SuperBackupMan`
- Observed command execution:
- `vssadmin delete shadows /all /quiet`
- `bcdedit.exe /set {current} safeboot minimal`
- `shutdown.exe /r /f /t 00`

## Yara rules
```yara
rule snatch_caro
{
  condition:
    new_file and ((signatures matches /.*Snatch.*/) or (signatures matches /.*Ransom.*Gocoder.*/))
}

import "cuckoo"
rule snatch_service
{
	condition:
		cuckoo.registry.key_access(/<HKLM>\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Minimal\\SuperBackupMan/)
			or
		cuckoo.registry.key_access(/HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Minimal\\SuperBackupMan/)
			or
		cuckoo.registry.key_access(/HKLM\\SYSTEM\\CurrentControlSet\\Control\\SafeBoot\\Minimal\\SuperBackupMan/)
}
```
